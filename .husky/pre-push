echo "ðŸ”¨ Running build before push..."
npm run build

if [ $? -ne 0 ]; then
  echo "âŒ Build failed! Push aborted." >&2
  exit 1
fi

echo "âœ… Build successful!"

branch_name=$(git symbolic-ref --short HEAD)

if [ "$branch_name" = "main" ] || [ "$branch_name" = "dev" ]; then
  echo "âŒ Direct push to branch $branch_name is not allowed!"
  echo "If you're sure that that's what you want to do, bypass this check via" >&2
  echo "" >&2
  echo "  git push --no-verify" >&2
  echo "" >&2
  exit 1
fi